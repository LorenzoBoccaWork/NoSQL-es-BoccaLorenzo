### Task 1.1
Creare o aggiornare un utente per email

db.users.updateOne(
  { email: "john.doe@example.com" },
  {
    $set: {
      name: { first: "John", last: "Doe" },
      status: "active"
    }
  },
  { upsert: true } 
)

--------------- Risposta terminale -------------
{
  acknowledged: true,
  insertedId: ObjectId('68ff29bead638301ba32fd60'),
  matchedCount: 0,
  modifiedCount: 0,
  upsertedCount: 1
}

### Task 1.2
Eseguire due volte upsert e osservare il risultato finale

1) Prima esecuzione
const result1 = db.users.updateOne(
  { email: "jane.doe@example.com" },
  { $set: { name: "Jane Doe" } },
  { upsert: true }
)
console.log(result1)
// { upsertedId: ObjectId("..."), matchedCount: 0, modifiedCount: 0 }

2) Seconda esecuzione
const result2 = db.users.updateOne(
  { email: "jane.doe@example.com" },
  { $set: { name: "Jane Doe Updated" } },
  { upsert: true }
)
console.log(result2)

-------------- Risposta terminale ----------------
1) {
  acknowledged: true,
  insertedId: ObjectId('68ff2a4bad638301ba32fea1'),
  matchedCount: 0,
  modifiedCount: 0,
  upsertedCount: 1
}

2) {
  acknowledged: true,
  insertedId: null,
  matchedCount: 1,
  modifiedCount: 1,
  upsertedCount: 0
}

### 2.1
Creare un utente con valori predefiniti, ma non sovrascrivere negli aggiornamenti

db.users.updateOne(
  { email: "user@example.com" },
  {
    $set: {
      name: "User Name",
      lastLogin: new Date()
    },
    $setOnInsert: {
      createdAt: new Date(),  
      role: "customer",      
      status: "active" 
    }
  },
  { upsert: true }
)

---------------- Risposta terminale --------------
{
  acknowledged: true,
  insertedId: null,
  matchedCount: 1,
  modifiedCount: 1,
  upsertedCount: 0
}

